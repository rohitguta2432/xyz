angular.module("selectize",[]).value("selectizeConfig",{}).directive("selectize",["selectizeConfig",function(n){return{restrict:"EA",require:"^ngModel",scope:{ngModel:"=",config:"=?",options:"=?",ngDisabled:"=",ngRequired:"&"},link:function(i,e,o,t){var l,a=angular.extend({},Selectize.defaults,n,i.config);i.options=i.options||[],i.config=i.config||{};var g=function(n){return void 0===n||null===n||!n.length},s=function(n){n?l.disable():l.enable()},c=function(){var n=(i.ngRequired()||o.required||a.required)&&g(i.ngModel);t.$setValidity("required",!n)},r=function(n,i){angular.forEach(i,function(i){if(-1===n.indexOf(i)){var e=i[a.valueField];l.removeOption(e,!0)}}),l.addOption(n,!0),l.refreshOptions(!1),d()},d=function(){c(),l.$control.toggleClass("ng-valid",t.$valid),l.$control.toggleClass("ng-invalid",t.$invalid),l.$control.toggleClass("ng-dirty",t.$dirty),l.$control.toggleClass("ng-pristine",t.$pristine),angular.equals(l.items,i.ngModel)||l.setValue(i.ngModel,!0)};a.onChange=function(n){var n=angular.copy(l.items);1==a.maxItems&&(n=n[0]),t.$setViewValue(n),i.config.onChange&&i.config.onChange.apply(this,arguments)},a.onOptionAdd=function(n,e){-1===i.options.indexOf(e)&&(i.options.push(e),i.config.onOptionAdd&&i.config.onOptionAdd.apply(this,arguments))},a.onInitialize=function(){l=e[0].selectize,r(i.options),i.config.onInitialize&&i.config.onInitialize(l),i.$watchCollection("options",r),i.$watch("ngModel",d),i.$watch("ngDisabled",s)},e.selectize(a),e.on("$destroy",function(){l&&(l.destroy(),e=null)})}}}]);
